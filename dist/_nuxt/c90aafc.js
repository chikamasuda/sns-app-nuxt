(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{302:function(t,e,n){"use strict";n.r(e);var r=n(13),o=(n(70),n(120)),c={data:function(){return{post:{},postList:[],likes:[],comments:[],comment:"",text:"",number:0,postError:"",commentError:""}},computed:{user:function(){return this.$store.state.auth.currentUser}},methods:{logout:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.auth().signOut().then((function(data){t.$router.push("/login")})).catch((function(t){console.log(t)}));case 2:case"end":return e.stop()}}),e)})))()},getPostList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/posts");case 2:n=e.sent,t.postLists=n.data.data;case 4:case"end":return e.stop()}}),e)})))()},deletePost:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$axios.delete("/api/posts/"+t).then((function(data){e.getPostList(),e.$router.push("/posts")})).catch((function(t){console.log(t)}));case 2:case"end":return n.stop()}}),n)})))()},insertPost:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={text:t.text,uid:t.user.uid},e.next=3,t.$axios.post("/api/posts/",n).then((function(data){t.getPostList(),t.text="",t.postError=""})).catch((function(e){t.postError=e.response.data.data.errors.text[0]}));case 3:case"end":return e.stop()}}),e)})))()},like:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={uid:e.user.uid},n.next=3,e.$axios.post("/api/posts/"+t+"/like",r);case 3:e.getPost();case 4:case"end":return n.stop()}}),n)})))()},unlike:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={uid:e.user.uid},n.next=3,e.$axios.post("/api/posts/"+t+"/unlike",r);case 3:e.getPost();case 4:case"end":return n.stop()}}),n)})))()},getPost:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/posts/".concat(t.$route.params.id),e.next=3,t.$axios.get(n).then((function(e){console.log(e.data.post[0]),t.post=e.data.post[0],t.likes=e.data.post[0].likes})).catch((function(e){t.$router.push("/posts")}));case 3:case"end":return e.stop()}}),e)})))()},getComments:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/posts/".concat(t.$route.params.id,"/comments"),e.next=3,t.$axios.get(n).then((function(e){t.comments=e.data.comments})).catch((function(e){t.$router.push("/posts")}));case 3:case"end":return e.stop()}}),e)})))()},insertComment:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/posts/".concat(t.$route.params.id,"/comments"),r={comment:t.comment,uid:t.user.uid},e.next=4,t.$axios.post(n,r).then((function(data){t.getComments(),t.comment="",t.commentError=""})).catch((function(e){t.commentError=e.response.data.data.errors[""][0]}));case 4:case"end":return e.stop()}}),e)})))()}},created:function(){var t=this;this.getPostList(),this.getPost(),this.getComments(),o.a.auth().onAuthStateChanged(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n?(r=n.uid,t.$store.dispatch("auth/setUser",{uid:r})):(t.$store.dispatch("auth/setUser",null),t.$router.push("/login"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},m=c,l=n(40),component=Object(l.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"container",attrs:{dark:""}},[n("div",{staticClass:"sidebar"},[t._m(0),t._v(" "),n("nav",[n("ul",[n("li",{staticClass:"side-menu"},[n("NuxtLink",{staticClass:"sidebar-menu-item",attrs:{to:"/posts"}},[n("img",{attrs:{src:"/img/home.png",alt:"",width:"25"}}),t._v(" "),n("span",{staticClass:"sidemenu-text"},[t._v("ホーム")])])],1),t._v(" "),n("li",{staticClass:"side-menu",on:{click:t.logout}},[n("img",{attrs:{src:"/img/logout.png",alt:"",width:"25"}}),t._v(" "),n("span",{staticClass:"sidemenu-text"},[t._v("ログアウト")])])])]),t._v(" "),n("form",{staticClass:"post-form",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.insertPost()}}},[t._m(1),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{name:"text",id:"text",cols:"37",rows:"6"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),t.postError?n("p",{staticClass:"errors"},[t._v(t._s(t.postError))]):t._e(),t._v(" "),n("button",{staticClass:"button",attrs:{type:"submit"}},[t._v("シェアする")])])]),t._v(" "),n("section",{staticClass:"section"},[n("div",{staticClass:"comment-area"},[n("h2",{staticClass:"comment-title"},[t._v("コメント")]),t._v(" "),n("div",{staticClass:"post-list-item"},[t.user?n("div",{staticClass:"user-info"},[t.post.users?n("p",{staticClass:"user-name"},[t._v(t._s(t.post.users.name))]):t._e(),t._v(" "),t.likes.find((function(e){return e.uid===t.user.uid}))?n("div",[n("font-awesome-layers",{staticClass:"fa"},[n("font-awesome-icon",{staticClass:"heart red-text",attrs:{icon:"heart"},on:{click:function(e){return t.unlike(t.post.id)}}})],1),t._v(" "),n("span",{staticClass:"number"},[t._v(t._s(t.likes.length))])],1):t._e(),t._v(" "),t.likes.find((function(e){return e.uid===t.user.uid}))?t._e():n("div",[n("font-awesome-layers",{staticClass:"fa"},[n("font-awesome-icon",{staticClass:"heart",attrs:{icon:"heart"},on:{click:function(e){return t.like(t.post.id)}}})],1),t._v(" "),n("span",{staticClass:"number"},[t._v(t._s(t.likes.length))])],1),t._v(" "),n("span",{on:{click:function(e){return t.deletePost(t.post.id)}}},[n("img",{staticClass:"cross",attrs:{src:"/img/cross.png",alt:"削除",width:"25"}})])]):t._e(),t._v(" "),n("p",{staticClass:"content"},[t._v(t._s(t.post.text))])]),t._v(" "),n("h3",{staticClass:"comment-list-title"},[t._v("コメント")]),t._v(" "),t._l(t.comments,(function(e){return n("ul",{key:e.id,staticClass:"comment-list-item"},[n("li",[n("p",{staticClass:"comment-name"},[t._v(t._s(e.users.name))]),t._v(" "),n("p",{staticClass:"comment-text"},[t._v(t._s(e.comment))])])])}))],2),t._v(" "),n("form",{staticClass:"comment-form",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.insertComment()}}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],attrs:{name:"text",id:"text",rows:"2"},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),t.commentError?n("p",{staticClass:"errors"},[t._v(t._s(t.commentError))]):t._e(),t._v(" "),n("button",{staticClass:"button btn-padding",attrs:{type:"submit"}},[t._v("コメント")])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{staticClass:"logo"},[e("img",{attrs:{src:"/img/logo.png",alt:"ロゴ",width:"100"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-form-label"},[n("label",{attrs:{for:""}},[t._v("シェア")])])}],!1,null,null,null);e.default=component.exports}}]);